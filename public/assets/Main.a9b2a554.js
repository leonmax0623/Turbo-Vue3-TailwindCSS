import{c as e,P as o,w as s,r as a,V as l,o as r,d as t,e as i,j as d,J as c,u as m,v as n,h as p,a1 as u,W as f,X as b,l as _,t as j}from"./vendor.36c281f3.js";import{_ as v}from"./Button.4b020695.js";import{_ as g}from"./TextArea.fcc59b75.js";import{_ as V}from"./Input.b03a61c6.js";import{_ as h}from"./StoSelect.c4156f5b.js";import{s as x}from"./OrderForm.cc8dadca.js";import{s as k}from"./employees.2bffecd5.js";import{c as y}from"./clients.e20f9038.js";import{c as w}from"./cars.41f6223d.js";import{a as B}from"./why.059bca86.js";import{p as C}from"./index.a1f0654c.js";import{o as F}from"./stages.6e22bacf.js";import{c as U}from"./CarFormFields.c5e9346f.js";import{c as T}from"./ClientFormFields.5fcad639.js";import{_ as M}from"./Files.f3d09fe4.js";import{u as S}from"./useConfirmDialog.ba73d887.js";import{q as $,g as A}from"./useAvatar.7737e550.js";import"./ExclamationCircleIcon.22c0ccb9.js";import"./useIntersectionObserver.7ad3d6a4.js";import"./index.8fc70fb6.js";import"./Office.55bfbecd.js";import"./headlessui.esm.b519f347.js";import"./Avatar.4eeca634.js";import"./Dropdown.df5c89e3.js";import"./NavBar.2f63176e.js";import"./departments.4f88a00d.js";import"./drop.cce90c26.js";import"./meta.48f5205a.js";import"./useSuspense.29183c13.js";import"./Spinner.2e0ab286.js";import"./orders.a1ebe807.js";import"./Select.bf4a4e1e.js";import"./marks.50b903c7.js";import"./carModelForm.2c8ceb25.js";import"./useModalForm.1c23c14e.js";import"./FormActions.47218f8a.js";import"./carModel.5c695b93.js";import"./carMarkForm.6681b855.js";import"./CarsTable.14d70802.js";import"./Link.4e9a6f0f.js";import"./cars.efc7eb58.js";import"./Table.ec42ea9a.js";import"./Th.32cd08d3.js";import"./Badge.4bd69676.js";import"./Dialog.b36041f9.js";const D={class:"mb-5"},I=_("Сохранить"),O={class:"grid grid-cols-12 gap-6"},P={key:0,class:"col-span-12 sm:col-span-4"},z={class:"col-span-12 sm:col-span-4"},E={class:"col-span-12 sm:col-span-4 flex items-center"},q={class:"col-span-12 sm:col-span-4 flex items-center"},J={class:"col-span-12 sm:col-span-4"},L={class:"col-span-12 sm:col-span-4"},N={class:"col-span-12 sm:col-span-4"},W={class:"col-span-12 sm:col-span-12"},X={class:"col-span-12"},G=i("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Чек лист",-1),H={class:"w-5 pt-2"},K=_("Удалить"),Q=_("Добавить"),R={async setup(_){let R,Y;const{options:Z,load:ee}=F,{load:oe,options:se}=k,{reset:ae,fill:le,options:re}=y,{fill:te,options:ie,reset:de}=w,{reset:ce,fill:me,options:ne}=B,{reset:pe,fill:ue,state:fe}=C,{fields:be,atMounted:_e,saveOrder:je,current:ve,log:ge,isEditPage:Ve,route:he,v$:xe}=x(),{render:ke}=U(!0),{modalUp:ye}=T(!0),we=$((e=>be.checkboxes.splice(e,1)),e((()=>be.checkboxes.length>1)));o(de),s((()=>be.client_id),(async e=>{de(),await te({client_id:e})}));const Be=a(""),Ce=ve.value;[R,Y]=l((()=>Promise.all([async()=>{ae(),ce(),pe(),de()},ee(),me(),ue(),oe({department_id:Ce}),le({department_id:Ce}),_e()]).then((()=>{Ve.value&&(Be.value=`#${A(he.params.id)}`)})))),R=await R,Y();const{simple:Fe}=S(),Ue=e((()=>fe.raw.filter((({appeal_reason:e})=>e.id==be.appeal_reason_id)).map((({id:e,name:o})=>({value:e,label:o})))));return o((()=>{Ve.value||(be.order_stage_id=Z.value[0].value)})),(e,o)=>{var s;return r(),t("div",null,[i("div",D,[d(v,{color:"blue",onClick:m(je)},{default:c((()=>[d(m(n),{class:"w-5 h-5 mr-1"}),I])),_:1},8,["onClick"])]),i("div",O,[m(Ve)?(r(),t("div",P,[d(V,{label:"Номер заказ-наряда",disabled:"",modelValue:Be.value,"onUpdate:modelValue":o[0]||(o[0]=e=>Be.value=e)},null,8,["modelValue"])])):p("",!0),i("div",z,[d(h,{search:"",onBottomTouched:o[1]||(o[1]=()=>{}),label:"Ответственный",options:m(se),modelValue:m(be).user_id,"onUpdate:modelValue":o[2]||(o[2]=e=>m(be).user_id=e)},null,8,["options","modelValue"])]),i("div",E,[d(h,{search:!0,class:"flex-grow mr-1",label:"Клиент",options:m(re),modelValue:m(be).client_id,"onUpdate:modelValue":o[3]||(o[3]=e=>m(be).client_id=e),onBottomTouched:o[4]||(o[4]=()=>m(le)({department_id:m(Ce)}))},null,8,["options","modelValue"]),d(m(u),{class:"w-6 text-gray-600 cursor-pointer hover:text-gray-800",onClick:o[5]||(o[5]=()=>m(ye)())})]),i("div",q,[d(h,{onBottomTouched:o[6]||(o[6]=()=>m(te)({client_id:m(be).client_id})),search:!0,class:"flex-grow mr-1",label:"Автомобиль",options:m(ie),modelValue:m(be).car_id,"onUpdate:modelValue":o[7]||(o[7]=e=>m(be).car_id=e),disabled:!m(be).client_id,key:m(be).client_id},null,8,["options","modelValue","disabled"]),d(m(u),{class:"w-6 text-gray-600 cursor-pointer hover:text-gray-800",onClick:o[8]||(o[8]=()=>m(ke)(m(be).client_id))})]),i("div",J,[d(h,{onBottomTouched:o[9]||(o[9]=()=>m(me)()),label:"Причина обращения",options:m(ne),modelValue:m(be).appeal_reason_id,"onUpdate:modelValue":o[10]||(o[10]=e=>m(be).appeal_reason_id=e)},null,8,["options","modelValue"])]),i("div",L,[d(h,{onBottomTouched:o[11]||(o[11]=()=>m(ue)()),label:"Процесс",options:m(Ue),modelValue:m(be).process_category_id,"onUpdate:modelValue":o[12]||(o[12]=e=>m(be).process_category_id=e)},null,8,["options","modelValue"])]),i("div",N,[d(h,{onBottomTouched:o[13]||(o[13]=()=>m(ee)()),label:"Этап заказ наряда",options:m(Z),modelValue:m(be).order_stage_id,"onUpdate:modelValue":o[14]||(o[14]=e=>m(be).order_stage_id=e),error:null==(s=m(xe).order_stage_id.$errors[0])?void 0:s.$message,onBlured:m(xe).order_stage_id.$touch},null,8,["options","modelValue","error","onBlured"])]),i("div",W,[d(g,{label:"Комментарий",modelValue:m(be).comment,"onUpdate:modelValue":o[15]||(o[15]=e=>m(be).comment=e)},null,8,["modelValue"])]),i("div",X,[G,i("ul",null,[(r(!0),t(f,null,b(m(be).checkboxes,((e,o)=>(r(),t("li",{key:"input-"+o,class:"flex items-start mb-2"},[i("span",H,j(o+1),1),d(V,{rows:"1",class:"flex-grow mx-2",placeholder:"Текст задачи",modelValue:m(be).checkboxes[o],"onUpdate:modelValue":e=>m(be).checkboxes[o]=e},null,8,["modelValue","onUpdate:modelValue"]),d(v,{color:"red",size:"sm",onClick:e=>m(we)(o)},{default:c((()=>[K])),_:2},1032,["onClick"])])))),128))]),d(v,{size:"xs",class:"mt-4",onClick:o[16]||(o[16]=e=>m(be).checkboxes.push(""))},{default:c((()=>[Q])),_:1})]),d(M,{log:m(ge),files:m(be).files,onFileDropped:o[17]||(o[17]=e=>m(Fe)((()=>(e=>{be.delete_file_ids.push(e),be.files.deleteById(e)})(e))))},null,8,["log","files"])])])}}};export{R as default};
