import{V as e,o as a,d as s,e as o,j as r,u as t,S as l,c as n,H as d,ag as i,f as c,J as m,l as u,t as p,Y as f,av as j,a1 as b}from"./vendor.36c281f3.js";import{_}from"./Office.55bfbecd.js";import{_ as v}from"./Button.4b020695.js";import{u as g}from"./useSuspense.29183c13.js";import{_ as y}from"./Link.4e9a6f0f.js";import{u as w}from"./useConfirmDialog.ba73d887.js";import{o as k}from"./stages.6e22bacf.js";import{_ as V}from"./Table.ec42ea9a.js";import{_ as h}from"./Input.b03a61c6.js";import{c as C,s as D}from"./useAvatar.7737e550.js";import{u as M}from"./useModalForm.1c23c14e.js";import{b as O}from"./index.8fc70fb6.js";import{$ as S}from"./drop.cce90c26.js";import"./headlessui.esm.b519f347.js";import"./Avatar.4eeca634.js";import"./Dropdown.df5c89e3.js";import"./NavBar.2f63176e.js";import"./departments.4f88a00d.js";import"./meta.48f5205a.js";import"./Spinner.2e0ab286.js";import"./Dialog.b36041f9.js";import"./Th.32cd08d3.js";import"./useIntersectionObserver.7ad3d6a4.js";import"./ExclamationCircleIcon.22c0ccb9.js";import"./FormActions.47218f8a.js";const x={async setup(l){let n,d;const{order_stage:i,atMounted:c}=E();return[n,d]=e((()=>c())),n=await n,d(),(e,l)=>(a(),s("div",null,[o("div",null,[r(h,{label:"Название",modelValue:t(i).name,"onUpdate:modelValue":l[0]||(l[0]=e=>t(i).name=e),required:!0},null,8,["modelValue"])]),o("div",null,[r(h,{label:"Цвет",type:"color",modelValue:t(i).color,"onUpdate:modelValue":l[1]||(l[1]=e=>t(i).color=e),required:!0},null,8,["modelValue"])])]))}},{add:A}=k,F=O();let I;const q=async()=>{const{id:e}=I;if(e){const a=await S.order_stage(e);((e={})=>{I.id=e.id,I.name=e.name,I.color=e.color})(null!=a?a:{})}},B=(...e)=>{const a=l();a.run((()=>{const s=n((()=>!!(null==I?void 0:I.id))),{render:o}=M({title:n((()=>C.modal[s.value?"update":"create"].order_stage)),RawForm:x,atSubmit:()=>(async()=>{const{message:e,success:a,data:s}=await D.order_stage(I);try{return{message:e,success:a}}finally{a&&(A(s.order_stage),F.success(e))}})(),atClose:()=>a.stop(),atOpen:e=>{I=d({id:null!=e?e:"",name:"",color:""})}});o(...e),i((()=>{I=void 0}))}))};function E(){return{order_stage:I,atMounted:q,render:B}}const T={async setup(s){let l,n;const{state:d,load:i,drop:j}=k;[l,n]=e((()=>i())),l=await l,n();const b=[{label:"Название",key:"name"},{label:"Цвет",key:"color"},{label:"Дата создания",key:"created_at"}],{drop:_}=w(),{render:v}=E();return(e,s)=>(a(),c(V,{fields:b,items:t(d).raw,onDelete:s[0]||(s[0]=e=>t(_)((()=>t(j)(e)))),onEdit:s[1]||(s[1]=e=>t(v)(e))},{"td-name":m((({value:e,item:{id:a}})=>[r(y,{onClick:()=>t(v)(a)},{default:m((()=>[u(p(e),1)])),_:2},1032,["onClick"])])),"td-color":m((({value:e})=>[o("div",{class:"w-9 h-9 border shadow-sm rounded-full",style:f({background:e})},null,4)])),"td-created_at":m((({value:e})=>{var a;return[u(p(null!=(a=null==e?void 0:e.split(" ")[0])?a:"_"),1)]})),_:1},8,["items"]))}},U=u("К заказам "),H=u("Создать "),J={setup(e){const{render:s}=E(),o=g(T);return(e,l)=>(a(),c(_,{title:"Этапы заказа"},{actions:m((()=>[r(v,{type:"secondary",link:{name:"Orders"}},{default:m((()=>[r(t(j),{class:"w-5 h-5 mr-1"}),U])),_:1}),r(v,{color:"blue",onClick:l[0]||(l[0]=()=>t(s)())},{default:m((()=>[r(t(b),{class:"w-5 h-5 mr-1"}),H])),_:1})])),default:m((()=>[r(t(o),{loadingMsg:"получение этапов..."})])),_:1}))}};export{J as default};
