import{o as e}from"./useOrder.941ce970.js";import{d as a}from"./departments.4f88a00d.js";import{s as r}from"./index.e517b156.js";import{u as s}from"./useConfirmDialog.ba73d887.js";import{a as t}from"./index.8fc70fb6.js";import{f as i}from"./useAvatar.7737e550.js";import{S as o,H as d}from"./vendor.36c281f3.js";const{load:n,sort:m,fill:l,reset:c,drop:u,fillArchived:f}=r,{current:p}=a,v={id:{label:"По умолчанию",sort:(e,a)=>e.id-a.id},name:{label:"По имени",sort:(e,a)=>e.name>a.name?1:e.name<a.name?-1:0},status:{label:"По статусу",sort:(e,a)=>e.status-a.status},user_id:{label:"По пользователю",sort:(e,a)=>{var r,s;return(null==(r=e.user)?void 0:r.id)-(null==(s=a.user)?void 0:s.id)}},date:{label:"По дате",sort:(e,a)=>new Date(e.created_at).getTime()-new Date(a.created_at).getTime()}};let _,b;const j=()=>{_=void 0,b=void 0};var w=a=>o().run((()=>{const r=e(v,"id",(e=>{m(e)}),1);null!=a&&(b=a),_||(_=d({name:"",status:"",user_id:"",order_id:"",pipeline_id:"",department_id:p}));const{drop:o}=s(),{redirectTo:w}=t();return{order:r,filter:_,removeTask:(e,a=!1)=>{o((async()=>{const{success:r,message:s}=await u(e);try{return{success:r,message:s}}finally{r&&a&&await w({name:"Tasks"})}}))},edit:async e=>{await w({name:"TaskEdit",params:{id:e}})},resetFilter:()=>{Object.keys(_).forEach((e=>{"department_id"!==e&&(_[e]="")}))},fetchTasks:async(e=!1,a,r)=>{e&&c(),a?await n({order_id:a,is_map:r,history:"order"},!1):_.department_id&&(b.value?await f(i(_)):await l(i(_)))},current:p,clearMemo:j}}));export{w as t};
