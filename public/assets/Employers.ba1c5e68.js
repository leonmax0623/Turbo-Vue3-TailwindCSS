import{o as e,f as l,j as a,d as t,e as s,Y as r,h as o,t as i,J as n,u,i as d,l as c,A as m,w as f,c as p,r as v,a1 as g}from"./vendor.36c281f3.js";import{a as y}from"./useAvatar.7737e550.js";import{r as x,_ as b}from"./Office.55bfbecd.js";import{_ as w}from"./Button.4b020695.js";import{_ as h}from"./StackedListWithHeadings.ecbddc3f.js";import{r as _}from"./PencilIcon.e50c0995.js";import{_ as j,a as k,b as z}from"./DescriptionListItems.7babd672.js";import{u as V}from"./useConfirmDialog.ba73d887.js";import{s as $}from"./employees.2bffecd5.js";import{o as I}from"./useOrder.941ce970.js";import{d as M}from"./departments.4f88a00d.js";import{_ as S}from"./Input.b03a61c6.js";import{_ as B}from"./Spinner.2e0ab286.js";import"./index.8fc70fb6.js";import"./headlessui.esm.b519f347.js";import"./Avatar.4eeca634.js";import"./Dropdown.df5c89e3.js";import"./NavBar.2f63176e.js";import"./meta.48f5205a.js";import"./useIntersectionObserver.7ad3d6a4.js";import"./Badge.4bd69676.js";import"./Dialog.b36041f9.js";import"./drop.cce90c26.js";import"./ExclamationCircleIcon.22c0ccb9.js";function C(t,s){return e(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[a("path",{"fill-rule":"evenodd",d:"M3 3a1 1 0 011-1h12a1 1 0 011 1v3a1 1 0 01-.293.707L12 11.414V15a1 1 0 01-.293.707l-2 2A1 1 0 018 17v-5.586L3.293 6.707A1 1 0 013 6V3z","clip-rule":"evenodd"})])}function A(t,s){return e(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[a("path",{d:"M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z"})])}function E(t,s){return e(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[a("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"})])}function L(t,s){return e(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[a("path",{d:"M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"})])}const D={class:"flex-1 relative z-0 overflow-y-auto focus:outline-none xl:order-last"},H={class:"border-b border-gray-200 flex justify-between px-4 sm:px-6 py-3 lg:items-end items-baseline lg:flex-row flex-col gap-2"},O={class:"flex items-end"},T={class:"text-2xl font-bold text-gray-900 truncate"},F=["href"],N=c("Позвонить "),U={props:{phone:{type:String},avatar:{type:String,default:""},full_name:{type:String,default:"Full name"}},setup:l=>(c,m)=>{var f;return e(),t("div",D,[s("article",null,[s("div",H,[s("div",O,[l.avatar?(e(),t("div",{key:0,class:"w-32 h-32 rounded-full mr-2 bg-center bg-no-repeat bg-cover shadow-sm",style:r(`background-image: url(${l.avatar});`)},null,4)):o("",!0),s("h1",T,i(null!=(f=l.full_name)?f:""),1)]),a(w,{type:"secondary",size:"sm"},{default:n((()=>{var e;return[s("a",{href:`tel:${null!=(e=l.phone)?e:""}`,class:"flex items-center"},[a(u(A),{class:"mr-2 h-5 w-5 text-gray-400"}),N],8,F)]})),_:1})]),a(u(k),{bordered:!1,class:"mt-5 mb-10",type:"columns"},{default:n((()=>[a(u(j),{type:"columns"},{default:n((()=>[d(c.$slots,"description-list")])),_:3})])),_:3}),d(c.$slots,"actions")])])}},J=c("Изменить "),P=c("Удалить "),R={setup(t){const{drop:s}=V(),{drop:r,selectedUser:o}=$;return(t,i)=>{var d;const c=m("v-can");return e(),l(U,{phone:u(o).phone,avatar:u(o).avatar,full_name:`${u(o).name} ${null!=(d=u(o).surname)?d:""}`},{"description-list":n((()=>{var e;return[a(u(z),{label:"Телефон",value:u(o).phone,type:"columns"},null,8,["value"]),a(u(z),{label:"Почта",value:u(o).email,type:"columns"},null,8,["value"]),a(u(z),{label:"Отдел",value:null==(e=u(o).department)?void 0:e.name,type:"columns"},null,8,["value"]),a(u(z),{label:"Должность",value:u(o).office_position,type:"columns"},null,8,["value"]),a(c,{ability:"crud users",orIf:!u(o).is_born_at_visible},{default:n((()=>[a(u(z),{label:"Дата рождения",value:u(o).born_at,type:"columns"},null,8,["value"])])),_:1},8,["orIf"]),a(c,{ability:"crud users",orIf:!u(o).is_about_visible},{default:n((()=>[a(u(z),{label:"О сотруднике",type:"columns",columns:"2",value:u(o).about},null,8,["value"])])),_:1},8,["orIf"])]})),actions:n((()=>[a(c,{ability:"crud users",class:"px-6 flex justify-between"},{default:n((()=>[a(w,{type:"secondary",size:"xs",link:{name:"EditEmployer",params:{id:u(o).id}}},{default:n((()=>[a(u(_),{class:"mr-2 h-5 w-5 text-gray-400"}),J])),_:1},8,["link"]),a(w,{size:"xs",color:"red",onClick:i[0]||(i[0]=()=>u(s)((()=>u(r)(u(o).id))))},{default:n((()=>[a(u(E),{class:"mr-2 h-5 w-5 text-white"}),P])),_:1})])),_:1})])),_:1},8,["phone","avatar","full_name"])}}},{current:W}=M,{load:Y,sort:q,state:G}=$,K={id:{label:"По умолчанию",sort:(e,l)=>e.id-l.id},surname:{label:"По фамилии",sort:(e,l)=>e.surname>l.surname?1:e.surname<l.surname?-1:0}};const Q={class:"flex-1 relative z-0 flex md:overflow-hidden overflow-visible flex-col md:flex-row"},X={class:"order-2 md:order-first md:flex md:flex-col flex-shrink-0 w-96 border-r border-gray-200"},Z={class:"px-6 pt-6 pb-4"},ee=s("h2",{class:"text-lg font-medium text-gray-900"},"Картотека",-1),le={key:0,class:"mt-1"},ae=s("span",{class:"text-sm text-gray-600"},"Загрузка данных...",-1),te={key:1,class:"mt-1 text-sm text-gray-600"},se={class:"mt-6 flex space-x-4 items-start"},re={key:1,class:"flex flex-col items-center justify-center w-full"},oe={class:"mt-2 block text-sm font-medium text-gray-900"},ie={props:{selectText:{type:String,default:"Выберите сотрудника"},loading:{type:Boolean,default:!1},selected:{type:Boolean,default:!1},message:{type:String},modelValue:{type:[String,Number]}},emits:["toggle-filter","update:modelValue"],setup:l=>(r,o)=>(e(),t("div",Q,[s("div",X,[s("div",Z,[ee,l.loading?(e(),t("div",le,[a(B,{h:"4",w:"4"},{default:n((()=>[ae])),_:1})])):(e(),t("p",te,[s("span",null,i(l.message),1)])),s("div",se,[a(S,{placeholder:"Поиск",class:"flex-grow",icon:u(x),onInput:o[0]||(o[0]=e=>r.$emit("update:modelValue",e.target.value))},null,8,["icon"]),a(w,{type:"secondary",onClick:o[1]||(o[1]=()=>r.$emit("toggle-filter"))},{default:n((()=>[a(u(C),{class:"w-5 h-5 text-gray-400"})])),_:1})]),d(r.$slots,"filter")]),d(r.$slots,"list")]),l.selected?d(r.$slots,"preview",{key:0}):(e(),t("div",re,[a(u(L),{class:"h-12 w-12 mx-auto text-gray-600"}),s("span",oe,i(l.selectText),1)]))]))},ne=c("Роли "),ue=c("Создать "),de={setup(t){const{state:s,count:r,selected:o,select:i,directory:d}=$,{order:c,fetchEmployers:x}=function(){const e=I(K,"id",(e=>{q(e)})),l=async l=>{!G.loading&&W.value&&(e.active.value=!1,await Y({order:e.criteria.value,name:l,department_id:W.value}),e.trigger())};return f(W,(async()=>{await l()}),{immediate:!0}),{order:e,fetchEmployers:l}}(),_=c.comp(),j=p((()=>r.value>1?`Искать среди ${r.value} сотрудников`:1===r.value?"Oдин пользователь!":"нет пользователей!")),k=v("");return f(k,y(x),{}),(t,f)=>{const p=m("v-can");return e(),l(b,{title:"Сотрудники","main-classes":"flex flex-col min-w-0 flex-1 md:overflow-hidden overflow-auto"},{actions:n((()=>[a(p,{ability:"crud roles"},{default:n((()=>[a(w,{type:"secondary",link:{name:"Roles"}},{default:n((()=>[a(u(L),{class:"w-5 h-5 mr-1"}),ne])),_:1})])),_:1}),a(p,{ability:"crud users"},{default:n((()=>[a(w,{color:"blue",link:{name:"EmployerForm"}},{default:n((()=>[a(u(g),{class:"w-5 h-5 mr-1"}),ue])),_:1})])),_:1})])),content:n((()=>[a(ie,{onToggleFilter:f[0]||(f[0]=e=>u(c).active.value=u(r)>1&&!u(c).active.value),selectText:"Выберите сотрудника",loading:u(s).loading,message:u(j),selected:u(o),modelValue:k.value,"onUpdate:modelValue":f[1]||(f[1]=e=>k.value=e)},{filter:n((()=>[a(u(_))])),list:n((()=>[a(h,{class:"flex-1 min-h-0 overflow-y-auto",items:u(d),onSelect:u(i),key:u(c).key.value,selected:u(s).selectedId},null,8,["items","onSelect","selected"])])),preview:n((()=>[a(R)])),_:1},8,["loading","message","selected","modelValue"])])),_:1})}}};export{de as default};
