var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,d=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{o,d as n,e as c,t as i,u as b,l as p,W as f,X as u,n as m,h as x,L as k,M as v,r as w,c as y,H as _,U as g,P as h,w as j,N as O,aH as U,at as V,f as $,j as P,_ as H}from"./vendor.36c281f3.js";import{g as I,a as S,s as A,p as B}from"./useAvatar.7737e550.js";const E={class:"mb-6 py-3 mx-auto"},N={class:"text-center font-bold text-xl mb-6"},z=p("Диагностическая карта "),D=c("span",null,"№",-1),L=p(),M={class:"grid grid-cols-12 border-black border"},T={class:"text-left px-9 col-span-4"},W=c("b",{class:"mr-6"},"Дата:",-1),X={class:"text-left px-9 col-span-4 border-l border-black"},q=c("b",{class:"mr-6"},"Авто:",-1),C=c("span",{class:"text-left px-9 col-span-4 border-l border-black"},[c("b",{class:"mr-6"},"№:"),p(i(" "))],-1),F={key:0,class:"flex justify-center flex-col items-center"},G={class:"text-center font-bold text-xl mb-3"},J={class:m([" border-t border-l border-black grid grid-cols-12"])},K={class:"text-left p-1 flex items-center"},Q={class:"w-12 relative border-black border-l ml-auto check_area"},R={key:1},Y={class:"font-bold text-xl text-center mb-3"},Z={class:"text-center pl-2"},ee={key:2,class:"flex items-center justify-center"},ae={class:"border border-black flex items-center justify-center mx-auto"},le=c("span",{class:"px-4 p-1 flex items-center justify-start"},"Показания",-1),te={class:m(["flex-col"])},se={class:"col-span-1 flex border-b border-black"},re={class:m(["w-64 border-l border-r border-black p-1 flex items-center justify-start"])},de={class:"pl-1 flex items-center flex-grow bg-gray-50 pr-1"},oe={class:"col-span-1 flex"},ne={class:m(["w-64 border-l border-r border-black p-1 flex items-center justify-start"])},ce={class:"pl-1 flex items-center flex-grow bg-gray-50 pr-1"},ie={props:{fields:Array,task_id:[Number,String,void 0,null],task:Object,answers:{type:Object,default:()=>({id:void 0,task_id:void 0,data:[]})}},setup(e){const a=e,l=(e,l)=>((e,a,l)=>e.findIndex((({type:e,token:t})=>t===a&&e===l)))(a.answers.data,e,l);return(a,t)=>{var s,r,d,k,v,w,y,_,g,h,j,O;return o(),n("div",{class:m([a.$attrs.class,"mx-auto px-20 py-5"])},[c("header",E,[c("h2",N,[z,D,L,c("span",null,i((null==(s=e.task)?void 0:s.id)?b(I)(null==(r=e.task)?void 0:r.id):"_____"),1)]),c("div",M,[c("span",T,[W,p(i(null==(d=e.task)?void 0:d.end_at),1)]),c("span",X,[q,p(" "+i(`${null!=(_=null==(y=null==(w=null==(v=null==(k=e.task)?void 0:k.order.car)?void 0:v.car_model)?void 0:w.car_mark)?void 0:y.name)?_:""} ${null!=(O=null==(j=null==(h=null==(g=e.task)?void 0:g.order.car)?void 0:h.car_model)?void 0:j.name)?O:"_"}`),1)]),C])]),c("div",null,[(o(!0),n(f,null,u(e.fields,(({data:a,type:t,token:s},r)=>(o(),n("div",{key:r,class:"my-9"},["check_list"===t?(o(),n("div",F,[c("h3",G,i(null==a?void 0:a.title),1),c("div",J,[(o(!0),n(f,null,u(a.items,((a,r)=>(o(),n("div",{key:`${r}-item`,class:m(["checklist-item flex items-stretch border-r border-b border-black col-span-4"])},[c("span",K,i(a),1),c("span",Q,[c("p",{class:m(["absolute top-0 bottom-0 left-0 right-0 flex items-center justify-center text-2xl",e.answers.data[l(s,t)].data[r]?"text-black":"text-transparent"])},i("✓"),2)])])))),128))])])):x("",!0),"text"===t?(o(),n("div",R,[c("h3",Y,i(a),1),c("p",Z,i(e.answers.data[l(s,t)].data),1)])):x("",!0),"indication"===t?(o(),n("div",ee,[c("div",ae,[le,c("ul",te,[c("li",se,[c("span",re,i(a[0]),1),c("span",de,i(e.answers.data[l(s,t)].data[0]),1)]),c("li",oe,[c("span",ne,i(a[1]),1),c("span",ce,i(e.answers.data[l(s,t)].data[1]),1)])])])])):x("",!0),c("div",{class:m((r+1)%6==0?"pagebreak":"")},null,2)])))),128))])],2)}}};k("data-v-37d16dc8");const be=["id"],pe={key:0,class:"absolute top-0 bottom-0 left-0 right-0 z-50 bg-gray-200 opacity-50"},fe={key:1,class:"mb-6 py-3 mx-auto"},ue={class:"text-center font-bold text-xl mb-6"},me=p("Диагностическая карта "),xe=c("span",null,"№",-1),ke=p(),ve={class:"grid grid-cols-12 border-black border"},we={class:"text-left px-9 col-span-12 md:col-span-4"},ye=c("b",{class:"mr-6"},"Дата:",-1),_e={class:"text-left px-9 col-span-12 md:col-span-4 border-l-0 md:border-l border-black border-t md:border-t-0 border-b md:border-b-0"},ge=c("b",{class:"mr-6"},"Авто:",-1),he=c("span",{class:"text-left px-9 col-span-12 md:col-span-4 border-l-0 md:border-l border-black"},[c("b",{class:"mr-6"},"№:"),p(i(" "))],-1),je={class:"mx-auto"},Oe={key:0,class:"flex justify-center flex-col"},Ue={class:"font-bold text-xl mb-3"},Ve={class:m(["mx-auto gap-6 flex flex-wrap"])},$e=["for"],Pe=["id","onUpdate:modelValue","disabled"],He={class:"text-left w-full md:whitespace-nowrap"},Ie={key:1,class:"flex flex-col"},Se={class:"font-bold text-xl text-left mb-3"},Ae=["disabled","onUpdate:modelValue"],Be={key:2,class:"border border-black flex flex-col md:flex-row mt-6"},Ee=c("span",{class:"px-4 p-1 flex items-center justify-start border-b border-black md:border-b-0"},"Показания",-1),Ne=["onUpdate:modelValue","disabled"],ze={class:"flex-grow col-span-1 flex flex-wrap md:flex-nowrap"},De=["onUpdate:modelValue","disabled"];v();const Le={props:{id:String,fields:Array,dc_template:Object,task:Object,map_answer:[Object,void 0,null],task_id:[Number,String,void 0,null],noHead:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},for_worker:{type:Boolean,default:!1}},setup(e){const k=e,v=B("dk-worker"),E=w(!1),N=y((()=>k.disabled||null==k.task_id&&null==k.map_answer)),z=e=>{const a=[];return e.forEach((({type:e,data:l,token:t})=>{const s={token:t,type:e};"check_list"===e?s.data=[...l.items].fill(!1):"text"===e?s.data="":"indication"===e&&(s.data=[...l].fill("")),a.push(s)})),a},D=_({id:void 0,task_id:void 0,data:[]}),L=(e,a,l)=>e.findIndex((({type:e,token:t})=>t===a&&e===l)),M=(e,a)=>L(D.data,e,a),T=g(!1),W=g(!1);h((()=>{const{task_id:e}=k;if(k.map_answer){const{id:e,data:a,task_id:l}=k.map_answer;D.data=a?(e=>{if(!e)return;const a=[];return k.fields.forEach((({type:l,data:t,token:s})=>{const r={token:s,type:l},d=L(e,s,l);"check_list"===l?r.data=d<0?[...t.items].fill(!1):t.items.map(((a,l)=>!!e[d].data[l])):"text"===l?r.data=d<0?"":e[d].data:"indication"===l&&(r.data=d<0?[...t].fill(""):[e[d].data[0],e[d].data[1]]),a.push(r)})),a})(a):z(k.fields),D.id=e,D.task_id=l}else D.data=z(k.fields),D.task_id=e;setTimeout((()=>{E.value=!0})),(D.task_id||0==D.task_id)&&j((()=>D.data),S((async()=>{T.value=!0,W.value=!1;const{data:e,success:a}=await A.map_answer(D);T.value=!1,a||(W.value=!0);const{map_answer:l}=e;(null==l?void 0:l.id)&&!D.id&&(D.id=null==l?void 0:l.id)})),{deep:!0})}));const X=k.fields.filter((({type:e})=>"check_list"===e)).reduce(((e,{data:o})=>o.items.reduce(((e,o)=>{return n=((e,a)=>{for(var l in a||(a={}))s.call(a,l)&&d(e,l,a[l]);if(t)for(var l of t(a))r.call(a,l)&&d(e,l,a[l]);return e})({},e),c={[o]:v()},a(n,l(c));var n,c}),e)),{});return(a,l)=>{var t,s,r,d,v,w,y,_,g,h;return E.value?(o(),n("div",{key:0,id:k.id,class:m([[b(T)?"blur":"",b(W)?"shadow-err":""],"relative text-center border-gray-300 border rounded shadow p-6 px-9 mx-auto max-w-6xl select-none"])},[b(T)?(o(),n("div",pe)):x("",!0),e.noHead?x("",!0):(o(),n("header",fe,[c("h2",ue,[me,xe,ke,c("span",null,i(e.task_id?b(I)(e.task_id):"_____"),1)]),c("div",ve,[c("span",we,[ye,p(i(null==(t=e.task)?void 0:t.end_at),1)]),c("span",_e,[ge,p(" "+i(`${null!=(w=null==(v=null==(d=null==(r=null==(s=e.task)?void 0:s.order.car)?void 0:r.car_model)?void 0:d.car_mark)?void 0:v.name)?w:""} ${null!=(h=null==(g=null==(_=null==(y=e.task)?void 0:y.order.car)?void 0:_.car_model)?void 0:g.name)?h:"_"}`),1)]),he])])),c("div",je,[(o(!0),n(f,null,u(e.fields,(({data:a,type:l,token:t},s)=>(o(),n("div",{key:s,class:"mb-16"},["check_list"===l?(o(),n("div",Oe,[c("h3",Ue,i(null==a?void 0:a.title),1),c("div",Ve,[(o(!0),n(f,null,u(a.items,((s,r)=>(o(),n("div",{key:`${r}-item`,class:m(["checklist-item relative col-span-12 flex",a.items.length<3?"sm:col-span-6":"",3===a.items.length?"sm:col-span-6 md:col-span-4":"",a.items.length>=4?"sm:col-span-6 md:col-span-4 xl:col-span-3":"",e.for_worker?"for_worker":""])},[c("label",{for:b(X)[s],class:"flex items-center"},[O(c("input",{type:"checkbox",id:b(X)[s],class:"rounded mr-2 bg-gray-50 p-2","onUpdate:modelValue":e=>b(D).data[M(t,l)].data[r]=e,disabled:b(N)},null,8,Pe),[[U,b(D).data[M(t,l)].data[r]]]),c("span",He,i(s),1)],8,$e)],2)))),128))])])):x("",!0),"text"===l?(o(),n("div",Ie,[c("h3",Se,i(a),1),O(c("textarea",{rows:"5",disabled:b(N),class:"w-full rounded-md bg-gray-50 select-none","onUpdate:modelValue":e=>b(D).data[M(t,l)].data=e},null,8,Ae),[[V,b(D).data[M(t,l)].data]])])):x("",!0),"indication"===l?(o(),n("div",Be,[Ee,c("ul",{class:m(["flex-grow",e.for_worker?"flex-col":"flex flex-wrap"])},[c("li",{class:m(["flex-grow col-span-1 flex flex-wrap md:flex-nowrap",["border-b border-black"]])},[c("span",{class:m([e.for_worker?"w-64":"md:whitespace-nowrap","border-b md:border-b-0 flex-grow md:flex-grow-0 md:border-l border-r border-black px-4 p-1 flex items-center justify-start"])},i(a[0]),3),O(c("input",{type:"text",class:"block w-full flex-grow bg-gray-50 border-none","onUpdate:modelValue":e=>b(D).data[M(t,l)].data[0]=e,disabled:b(N)},null,8,Ne),[[V,b(D).data[M(t,l)].data[0]]])]),c("li",ze,[c("span",{class:m([e.for_worker?"w-64":"md:whitespace-nowrap","border-b md:border-b-0 flex-grow md:flex-grow-0 md:border-l border-r border-black px-4 p-1 flex items-center justify-start"])},i(a[1]),3),O(c("input",{type:"text",class:"block w-full flex-grow bg-gray-50 border-none","onUpdate:modelValue":e=>b(D).data[M(t,l)].data[1]=e,disabled:b(N)},null,8,De),[[V,b(D).data[M(t,l)].data[1]]])])],2)])):x("",!0)])))),128))]),(o(),$(H,{to:"#printable"},[P(ie,{fields:e.fields,answers:b(D),task:e.task},null,8,["fields","answers","task"])]))],10,be)):x("",!0)}},__scopeId:"data-v-37d16dc8"};export{Le as _};
