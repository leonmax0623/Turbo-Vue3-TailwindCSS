import{V as e,o as a,f as t,J as s,e as l,j as o,l as r,t as i,u as d,h as n,P as u,r as m,w as p,ag as c,n as f,$ as b}from"./vendor.36c281f3.js";import{_}from"./Work.601ec4a0.js";import{_ as v}from"./Button.4b020695.js";import{_ as j}from"./ButtonGroup.f61666b1.js";import{_ as y}from"./Header.5847de72.js";import{_ as k}from"./Input.b03a61c6.js";import{_ as g}from"./Label.f0bc0125.js";import{_ as h}from"./Select.bf4a4e1e.js";import{o as w}from"./orders.a1ebe807.js";import{s as V,_ as x}from"./WorkerBadge.cc727e45.js";import{u as B}from"./useSuspense.29183c13.js";import{_ as T}from"./Link.4e9a6f0f.js";import{_ as S}from"./Avatar.4eeca634.js";import{_ as C}from"./Badge.4bd69676.js";import{_ as E}from"./Table.ec42ea9a.js";import{t as O,g as $,l as D,a as I,o as U}from"./useAvatar.7737e550.js";import{_ as W}from"./StoSelect.c4156f5b.js";import"./meta.48f5205a.js";import"./departments.4f88a00d.js";import"./drop.cce90c26.js";import"./index.8fc70fb6.js";import"./ExclamationCircleIcon.22c0ccb9.js";import"./useOrder.941ce970.js";import"./index.e517b156.js";import"./index.ce6adbb1.js";import"./Spinner.2e0ab286.js";import"./headlessui.esm.b519f347.js";import"./Dropdown.df5c89e3.js";import"./Th.32cd08d3.js";import"./useIntersectionObserver.7ad3d6a4.js";const A=["data-tooltip"],L={async setup(u){let m,p;const{fetchTasks:c,state:f}=V(),b=[{label:"Заказ-наряд",key:"order"},{label:"Название",key:"name"},{label:"Тип",key:"type"},{label:"Ответственный",key:"user"},{label:"Статус",key:"status"},{label:"Дата создания",key:"created_at"},{label:"Крайний срок",key:"deadline_at"}];return[m,p]=e((()=>c(!0))),m=await m,p(),(e,u)=>(a(),t(E,{onBottomTouched:u[0]||(u[0]=()=>d(c)()),fields:b,items:d(f).raw,noEdit:()=>!0,noDelete:()=>!0,actions:!1},{"td-name":s((({value:e,item:{id:a}})=>[l("span",{"data-tooltip":e,class:"tooltip"},[o(T,{href:{name:"WorkerTask",params:{id:a},query:{from:"tasks"}}},{default:s((()=>[r(i(d(O)(e)),1)])),_:2},1032,["href"])],8,A)])),"td-type":s((({item:{is_map:e}})=>[o(C,{point:!0,color:e?"green":"purple"},{default:s((()=>[r(i(e?"Диагностическая карта":"Задачa"),1)])),_:2},1032,["color"])])),"td-order":s((({value:e})=>[(null==e?void 0:e.id)?(a(),t(T,{key:0,disabled:!0,href:{name:"OrderEdit",params:{id:null==e?void 0:e.id}}},{default:s((()=>[r("#"+i(d($)(null==e?void 0:e.id)),1)])),_:2},1032,["href"])):n("",!0)])),"td-user":s((({value:e})=>{var a,t;return[o(S,{title:`${null!=(a=null==e?void 0:e.name)?a:""} ${null!=(t=null==e?void 0:e.middle_name)?t:""}`,subtitle:null==e?void 0:e.office_position,image:null==e?void 0:e.avatar},null,8,["title","subtitle","image"])]})),"td-status":s((({value:e})=>{var a;return[o(C,{point:!0,color:null==(a=d(D)[e])?void 0:a.color},{default:s((()=>{var a;return[r(i(null==(a=d(D)[e])?void 0:a.label),1)]})),_:2},1032,["color"])]})),"td-created_at":s((({value:e})=>[r(i(e.split(" ")[0]),1)])),"td-deadline_at":s((({value:e})=>[r(i(e),1)])),_:1},8,["items","noEdit","noDelete"]))}},q=r(" Задачи "),F={class:"flex flex-wrap gap-1 items-start"},G={class:"w-48"},H=r("Статус"),J=r("В работе"),M=r("Закрытые"),P={class:"text-center ml-3"},z=r("сбросить"),K={setup(e){const r=B(L),{options:i,load:n}=w,{filter:T,resetFilter:S,order:{criteriaOptions:C},current:E,clearMemo:O}=V();u((async()=>{E.value&&await n()}));const $=m("-");return p(T,I((()=>{$.value=U(T)}))),c(O),(e,n)=>(a(),t(_,{title:"Список задач"},{default:s((()=>[o(x),o(y,null,{default:s((()=>[q])),_:1}),l("div",F,[l("div",G,[o(k,{label:"Название",modelValue:d(T).name,"onUpdate:modelValue":n[0]||(n[0]=e=>d(T).name=e)},null,8,["modelValue"])]),l("div",null,[o(g,{class:"mb-1"},{default:s((()=>[H])),_:1}),o(j,null,{default:s((()=>[o(v,{type:"secondary",onClick:n[1]||(n[1]=e=>d(T).status="process"),group:"left",class:f(["whitespace-nowrap","process"===d(T).status?"bg-green-100":""])},{default:s((()=>[J])),_:1},8,["class"]),o(v,{type:"secondary",onClick:n[2]||(n[2]=e=>d(T).status="done"),group:"right",class:f(["whitespace-nowrap","done"===d(T).status?"bg-indigo-100":""])},{default:s((()=>[M])),_:1},8,["class"])])),_:1})]),l("div",null,[o(W,{onBottomTouched:n[3]||(n[3]=()=>{}),label:"Заказ-наряд",options:d(i),modelValue:d(T).order_id,"onUpdate:modelValue":n[4]||(n[4]=e=>d(T).order_id=e),class:"w-44"},null,8,["options","modelValue"])]),l("div",null,[o(h,{label:"Сортировать",options:d(C),modelValue:d(T).order,"onUpdate:modelValue":n[5]||(n[5]=e=>d(T).order=e),class:"w-44"},null,8,["options","modelValue"])]),l("div",P,[o(g,null,{default:s((()=>[z])),_:1}),o(v,{type:"secondary",class:"rounded-full",onClick:n[6]||(n[6]=()=>d(S)())},{default:s((()=>[o(d(b),{class:"h-4 w-4 text-gray-600"})])),_:1})])]),o(d(r),{key:`tab-${$.value}`})])),_:1}))}};export{K as default};
