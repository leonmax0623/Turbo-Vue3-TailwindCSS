import{V as e,o as a,f as t,u as s,S as r,c as o,H as m,ag as n,J as i,j as d,l as c,t as p,a1 as l}from"./vendor.36c281f3.js";import{_ as u}from"./Office.55bfbecd.js";import{_ as f}from"./Button.4b020695.js";import{u as j}from"./useSuspense.29183c13.js";import{_ as b}from"./Link.4e9a6f0f.js";import{u as v}from"./useConfirmDialog.ba73d887.js";import{_}from"./Input.b03a61c6.js";import{s as g,c as w}from"./useAvatar.7737e550.js";import{u as y}from"./useModalForm.1c23c14e.js";import{b as D}from"./index.8fc70fb6.js";import{d as C}from"./departments.4f88a00d.js";import{$ as F}from"./drop.cce90c26.js";import{_ as k}from"./Table.ec42ea9a.js";import"./headlessui.esm.b519f347.js";import"./Avatar.4eeca634.js";import"./Dropdown.df5c89e3.js";import"./NavBar.2f63176e.js";import"./meta.48f5205a.js";import"./Spinner.2e0ab286.js";import"./Dialog.b36041f9.js";import"./ExclamationCircleIcon.22c0ccb9.js";import"./FormActions.47218f8a.js";import"./Th.32cd08d3.js";import"./useIntersectionObserver.7ad3d6a4.js";const M={async setup(r){let o,m;const{department:n,atMountedDepartmentForm:i}=I();return[o,m]=e((()=>i())),o=await o,m(),(e,r)=>(a(),t(_,{label:"Название отдела",modelValue:s(n).name,"onUpdate:modelValue":r[0]||(r[0]=e=>s(n).name=e),required:!0},null,8,["modelValue"]))}},{addDepartment:S}=C,V=D();let h;const x=async()=>{const{message:e,success:a,data:t}=await g.department(h);try{return{message:e,success:a}}finally{a&&(S(t.department),V.success(e))}},A=async()=>{const{id:e}=h;if(e){((e={})=>{h.id=e.id,h.name=e.name})(await F.department(e)||{})}};function I(){return{saveForm:x,department:h,atMountedDepartmentForm:A,render:(...e)=>{const a=r();a.run((()=>{const t=o((()=>!!h.id)),{render:s}=y({title:o((()=>w.modal[t.value?"update":"create"].department)),RawForm:M,atSubmit:x,atClose:()=>a.stop(),atOpen:e=>{h=m({id:null!=e?e:"",name:""})}});s(...e),n((()=>{h=void 0}))}))}}}const O={async setup(r){let o,m;const{load:n,drop:l,departments:u}=C,{drop:f}=v(),j=[{label:"Название",key:"name"}],{render:_}=I();return[o,m]=e((()=>n())),o=await o,m(),(e,r)=>(a(),t(k,{fields:j,items:s(u),onDelete:r[0]||(r[0]=e=>s(f)((()=>s(l)(e)))),onEdit:r[1]||(r[1]=e=>s(_)(e))},{"td-name":i((({value:e,item:{id:a}})=>[d(b,{onClick:()=>s(_)(a)},{default:i((()=>[c(p(e),1)])),_:2},1032,["onClick"])])),_:1},8,["items"]))}},B=c("Создать "),E={setup(e){const{render:r}=I(),o=j(O);return(e,m)=>(a(),t(u,{title:"Отделы"},{actions:i((()=>[d(f,{color:"blue",onClick:m[0]||(m[0]=()=>s(r)())},{default:i((()=>[d(s(l),{class:"w-5 h-5 mr-1"}),B])),_:1})])),default:i((()=>[d(s(o),{loadingMsg:"получаем oтделы..."})])),_:1}))}};export{E as default};
