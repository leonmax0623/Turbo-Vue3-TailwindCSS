import{V as e,o as a,d as r,j as s,u as o,S as t,c as m,H as n,I as c,ag as d,f as i,J as l,l as u,t as p,av as f,a1 as j}from"./vendor.36c281f3.js";import{_ as b}from"./Office.55bfbecd.js";import{_ as v}from"./Button.4b020695.js";import{u as _}from"./useSuspense.29183c13.js";import{_ as y}from"./Link.4e9a6f0f.js";import{u as g}from"./useConfirmDialog.ba73d887.js";import{s as w}from"./producers.56ce0372.js";import{_ as $}from"./Table.ec42ea9a.js";import{_ as k}from"./Input.b03a61c6.js";import{s as C,c as F}from"./useAvatar.7737e550.js";import{u as h}from"./useModalForm.1c23c14e.js";import{b as M}from"./index.8fc70fb6.js";import{$ as S}from"./drop.cce90c26.js";import{c as B}from"./carModel.5c695b93.js";import"./headlessui.esm.b519f347.js";import"./Avatar.4eeca634.js";import"./Dropdown.df5c89e3.js";import"./NavBar.2f63176e.js";import"./departments.4f88a00d.js";import"./meta.48f5205a.js";import"./Spinner.2e0ab286.js";import"./Dialog.b36041f9.js";import"./Th.32cd08d3.js";import"./useIntersectionObserver.7ad3d6a4.js";import"./ExclamationCircleIcon.22c0ccb9.js";import"./FormActions.47218f8a.js";const D={async setup(t){let m,n;const{producer:c,atMountedProducerForm:d,v$:i}=P();return[m,n]=e((()=>d())),m=await m,n(),(e,t)=>{var m;return a(),r("div",null,[s(k,{label:"Название",modelValue:o(c).name,"onUpdate:modelValue":t[0]||(t[0]=e=>o(c).name=e),required:!0,error:null==(m=o(i).name.$errors[0])?void 0:m.$message,onBlured:o(i).name.$touch},null,8,["modelValue","error","onBlured"])])}}},{add:I}=w,V=M();let x,A;const O=async()=>{if(!(await A.value.$validate()))return;A.value.$reset();const{message:e,success:a,data:r}=await C.producer(x);try{return{message:e,success:a}}finally{a&&(I(r.producer),V.success(e))}},E=async()=>{const{id:e}=x;let a={};e&&(a=await S.producer(e)),((e={})=>{x.id=e.id,x.name=e.name})(a)};function P(){return{saveForm:O,producer:x,atMountedProducerForm:E,render:(...e)=>{const a=t(!0);a.run((()=>{const r=m((()=>!!x.id)),{render:s}=h({title:m((()=>F.modal[r.value?"update":"create"].producer)),RawForm:D,atSubmit:O,atClose:()=>a.stop(),atOpen:e=>{x=n({id:null!=e?e:"",name:""}),A=c(B(),x,{$lazy:!0})}});s(...e),d((()=>{x=void 0}))}))},v$:A}}const T={async setup(r){let t,m;const n=[{label:"Название",key:"name"},{label:"Дата создания",key:"created_at"}],{drop:c}=g(),{render:d}=P(),{producers:f,load:j,drop:b}=w;return[t,m]=e((()=>j())),t=await t,m(),(e,r)=>(a(),i($,{fields:n,items:o(f),onDelete:r[0]||(r[0]=e=>o(c)((()=>o(b)(e)))),onEdit:r[1]||(r[1]=e=>o(d)(e))},{"td-name":l((({value:e,item:{id:a}})=>[s(y,{onClick:()=>o(d)(a)},{default:l((()=>[u(p(e),1)])),_:2},1032,["onClick"])])),"td-created_at":l((({value:e})=>[u(p(e),1)])),_:1},8,["items"]))}},q=u("К складам "),z=u("Создать "),H={setup(e){const{render:r}=P(),t=_(T);return(e,m)=>(a(),i(b,{title:"Производители"},{actions:l((()=>[s(v,{type:"secondary",link:{name:"Storages"}},{default:l((()=>[s(o(f),{class:"w-5 h-5 mr-1"}),q])),_:1}),s(v,{color:"blue",onClick:m[0]||(m[0]=()=>o(r)())},{default:l((()=>[s(o(j),{class:"w-5 h-5 mr-1"}),z])),_:1})])),default:l((()=>[s(o(t),{loadingMsg:"Получаем производители..."})])),_:1}))}};export{H as default};
